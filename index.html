<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Recordatorios de Partido</title>
    <link rel="stylesheet" href="style.css">
    <!-- 
        TODO: Replace with your Google Cloud API Key and Client ID 
        These are required for Google Drive integration.
        Create them at https://console.cloud.google.com/
        Enable: Google Drive API, Google Picker API
        Configure OAuth 2.0 Consent Screen and Credentials (Web application type)
        Make sure to add your web app's origin (e.g., http://localhost:PORT or https://yourdomain.com) 
        to the "Authorized JavaScript origins" in your Client ID settings.
    -->
    <!-- <meta name="google-signin-client_id" content="YOUR_GOOGLE_CLIENT_ID.apps.googleusercontent.com"> -->
    <!-- <meta name="google-api-key" content="YOUR_GOOGLE_API_KEY"> -->

    <script type="importmap">
    {
        "imports": {
            "xlsx": "https://cdn.jsdelivr.net/npm/xlsx@0.18.5/xlsx.mjs"
        }
    }
    </script>
</head>
<body>
    <h1>Gestor de Recordatorios de Partido</h1>

    <div class="container">
        <p>Sube tu archivo Excel (.xlsx) o selecciona una Hoja de Cálculo de Google Drive.</p>
        <p>Columnas esperadas: Nombre Equipo, Celular, Hora Partido, Dia Partido, Nombre Cancha</p>
        <p class="info"><strong>Nota:</strong> Esta herramienta genera enlaces para enviar mensajes manualmente. Haz clic en los botones para abrir WhatsApp. Marca manualmente la confirmación de asistencia usando el botón correspondiente.</p>

        <div class="file-selection">
            <label for="excelFile" class="file-label">Seleccionar archivo local (.xlsx)</label>
            <input type="file" id="excelFile" accept=".xlsx, .xls">
            <button id="driveButton" class="drive-button" disabled>Seleccionar de Google Drive</button>
             <span id="authStatus" style="margin-left: 10px; font-size: 0.9em;"></span> <!-- Added for Auth Status -->
            <span id="fileName">Ningún archivo seleccionado</span>
        </div>


        <div id="output" class="output-container">
            <!-- Los resultados se mostrarán aquí -->
        </div>
    </div>

    <script src="script.js" type="module"></script>
    <!-- Google API Loader -->
    <script async defer src="https://apis.google.com/js/api.js" onload="gapiLoaded()"></script>
</body>
</html>